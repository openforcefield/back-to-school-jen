WARNING:tensorflow:From /Users/jenniferclark/mamba/envs/bts/lib/python3.12/site-packages/tensorflow/python/util/deprecation.py:588: calling function (from tensorflow.python.eager.polymorphic_function.polymorphic_function) with experimental_relax_shapes is deprecated and will be removed in a future version.
Instructions for updating:
experimental_relax_shapes is deprecated, use reduce_retracing instead
2025-09-04 19:09:50.850 | INFO     | __main__:split_train_test:92 - MinMax Splitting Options: {'seed': 42, 'frac_train': 0.95}
2025-09-04 19:09:50.850 | INFO     | __main__:split_train_test:95 - Loading dataset from: /Users/jenniferclark/bin/back-to-school-jen/2_filtered_results/raw-spice-95.0thpercentile
2025-09-04 19:09:50.892 | INFO     | __main__:split_train_test:99 - Loading smiles.json from: /Users/jenniferclark/bin/back-to-school-jen/2_filtered_results/raw-spice-95.0thpercentile/smiles.json
2025-09-04 19:09:50.904 | INFO     | __main__:split_train_test:114 - Total number of points: 24326
2025-09-04 19:09:50.904 | INFO     | __main__:split_train_test:121 - Splitting dataset into training and testing sets, writing to: /Users/jenniferclark/bin/back-to-school-jen/3_split_train_test/full_split
2025-09-04 19:13:00.159 | INFO     | __main__:split_train_test:146 - N_Train: 23109, N_Test: 1217, N_Total (before max_mols): 24326
Saving the dataset (0/5 shards):   0%|          | 0/23109 [00:00<?, ? examples/s]Saving the dataset (0/5 shards):  17%|█▋        | 4000/23109 [00:00<00:00, 27344.10 examples/s]Saving the dataset (1/5 shards):  20%|██        | 4622/23109 [00:00<00:00, 27344.10 examples/s]Saving the dataset (1/5 shards):  37%|███▋      | 8622/23109 [00:00<00:00, 28963.29 examples/s]Saving the dataset (2/5 shards):  40%|████      | 9244/23109 [00:00<00:00, 28963.29 examples/s]Saving the dataset (2/5 shards):  57%|█████▋    | 13244/23109 [00:00<00:00, 29858.10 examples/s]Saving the dataset (3/5 shards):  60%|██████    | 13866/23109 [00:00<00:00, 29858.10 examples/s]Saving the dataset (3/5 shards):  77%|███████▋  | 17866/23109 [00:00<00:00, 30136.62 examples/s]Saving the dataset (4/5 shards):  80%|████████  | 18488/23109 [00:00<00:00, 30136.62 examples/s]Saving the dataset (4/5 shards):  97%|█████████▋| 22488/23109 [00:00<00:00, 28067.51 examples/s]Saving the dataset (5/5 shards): 100%|██████████| 23109/23109 [00:00<00:00, 28067.51 examples/s]Saving the dataset (5/5 shards): 100%|██████████| 23109/23109 [00:00<00:00, 28540.41 examples/s]
Saving the dataset (0/1 shards):   0%|          | 0/1217 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 1217/1217 [00:00<00:00, 33835.79 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 1217/1217 [00:00<00:00, 33579.15 examples/s]
2025-09-04 19:13:01.026 | INFO     | __main__:split_train_test:153 - Done splitting dataset into training and testing sets.
Flattening the indices:   0%|          | 0/23109 [00:00<?, ? examples/s]Flattening the indices:   4%|▍         | 1000/23109 [00:00<00:02, 8524.44 examples/s]Flattening the indices:   9%|▊         | 2000/23109 [00:00<00:02, 8799.22 examples/s]Flattening the indices:  17%|█▋        | 4000/23109 [00:00<00:01, 10666.07 examples/s]Flattening the indices:  26%|██▌       | 6000/23109 [00:00<00:01, 11891.47 examples/s]Flattening the indices:  35%|███▍      | 8000/23109 [00:00<00:01, 12175.90 examples/s]Flattening the indices:  43%|████▎     | 10000/23109 [00:00<00:01, 12537.62 examples/s]Flattening the indices:  52%|█████▏    | 12000/23109 [00:01<00:00, 12519.15 examples/s]Flattening the indices:  61%|██████    | 14000/23109 [00:01<00:00, 12084.38 examples/s]Flattening the indices:  69%|██████▉   | 16000/23109 [00:01<00:00, 11683.59 examples/s]Flattening the indices:  78%|███████▊  | 18000/23109 [00:01<00:00, 11490.50 examples/s]Flattening the indices:  87%|████████▋ | 20000/23109 [00:01<00:00, 11273.27 examples/s]Flattening the indices:  95%|█████████▌| 22000/23109 [00:01<00:00, 11533.89 examples/s]Flattening the indices: 100%|██████████| 23109/23109 [00:02<00:00, 11364.59 examples/s]
Flattening the indices:   0%|          | 0/1217 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1217/1217 [00:00<00:00, 12338.42 examples/s]
2025-09-04 19:13:03.212 | INFO     | __main__:split_train_test:164 - Saved train/test smiles to /Users/jenniferclark/bin/back-to-school-jen/3_split_train_test/full_split/smiles_test_train.json
